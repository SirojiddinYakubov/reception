{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% block top %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{% static 'plugins/select2/css/select2.min.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css' %}">
    <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
    <link href="https://res.cloudinary.com/dxfq3iotg/raw/upload/v1581152092/smartwizard/smart_wizard.min.css"
          rel="stylesheet" type="text/css"/>
    <link href="https://res.cloudinary.com/dxfq3iotg/raw/upload/v1581152091/smartwizard/smart_wizard_theme_arrows.min.css"
          rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/account_statement/style.css' %}">

{% endblock top %}
{% block content %}


    <section class="py-3 mt-2 bg-info text-light">
        <div class="container">
            <div class="row text-center">
                <div class="col-12">
                    <h2>{% trans "Yangi avtomobilni ro'yhatdan o'tkazish" %}</h2>
                </div>
            </div>
        </div>
    </section>
    <div class="container-fluid mt-3">

        <div id="smartwizard">
            <ul>
                <li id="nav-1" style="width: 25%"><a href="#step-1">Qadam 1<br/><small>Foydalanuvchi</small></a></li>
                <li id="nav-2" style="width: 25%;"><a href="#step-2">Qadam 2<br/><small>Avtomashina</small></a></li>
                <li id="nav-3" style="width: 25%"><a href="#step-3">Qadam 3<br/><small>To'ov</small></a></li>
                <li id="nav-4" style="width: 25%"><a href="#step-4">Qadam 4<br/><small>Holat</small></a></li>
            </ul>
            <div class="mt-4">
                <div id="step-1">
                    <div class="row">
                        <div class="col-12">
                            <label class="not_copy">Foydalanuvchini tanlang?</label>
                            <select class="form-control" style="width: 100%;" id="person_type" required>
                                <option value="J">Jismoniy shaxs</option>
                                <option value="Y">Yuridik shaxs</option>
                            </select>
                            <p style="margin-top: 0;margin-bottom: 0; font-size: 0.8em" id="organization_div_alert"
                               class="text-danger not_copy">
                                Sizda tashkilot mavjud emas. <a href="{% url 'user:add_organization' %}">Tashkilotni
                                qo'shish </a> bo'limiga o'tib, tashkilotni ro'yhatga oling
                            </p>
                        </div>
                        <div class="col-12 mt-3" id="div_organization">
                            {% if organizations.count > 0 %}
                                <div class="form-group">
                                    <label class="not_copy">{% trans 'Korxonani tanlang:' %}</label>
                                    <select id="organization" name="organization" class="form-control select2"
                                            style="width: 100%;">
                                        {% for organization in organizations %}
                                            <option value="{{ organization.id }}">{{ organization.title }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div id="msdiv1">
                        <div class="row">
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label class="not_copy">{% trans 'Familiya:' %}</label>
                                <input type="text" class="form-control"
                                       placeholder="
                                               {% if request.user.last_name %}{{ request.user.last_name }}{% endif %}"
                                       disabled>
                            </div>
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label class="not_copy">{% trans 'Ism:' %}</label>
                                <input type="text" class="form-control" placeholder="
                                    {% if request.user.first_name %}{{ request.user.first_name }}{% endif %}"
                                       disabled>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label class="not_copy mt-2">{% trans 'Otasining ismi:' %}</label>
                                <input type="text" class="form-control" placeholder="
                                    {% if request.user.middle_name %}{{ request.user.middle_name }}{% endif %}"
                                       disabled>
                            </div>
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label class="not_copy mt-2">{% trans 'Passport:' %}</label>
                                <input type="text" class="form-control" placeholder="











                                        {% if request.user.passport_seriya and request.user.passport_number %}{{ request.user.passport_seriya }}{{ request.user.passport_number }}{% endif %}"
                                       disabled>
                            </div>
                        </div>

                    </div>
                    <div id="msdiv2" style="display: none">
                        <div class="row">
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label>{% trans 'Rahbar:' %}</label>
                                <input type="text" id="director" class="form-control" placeholder="" disabled>
                            </div>
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label>{% trans 'STIR raqam:' %}</label>
                                <input type="text" id="identification_number" class="form-control" placeholder=""
                                       disabled>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                                <label>{% trans 'Yuridik manzil:' %}</label>
                                <input type="text" id="legal_address" class="form-control" placeholder="" disabled>
                            </div>
                        </div>
                    </div>
                    <div class="text-right mt-4">
                        <button id="next1" class="col-3 col-md-2 col-sm-2 col-lg-2 col-xl-2 btn btn-primary">
                            Keyingi
                        </button>
                    </div>
                </div>
                <div id="step-2">
                    <div class="form-group">
                        <label class="label_required">{% trans 'Avtomobil modelini tanlang' %}</label>
                        <select id="car" name="car" class="form-control select2" style="width: 100%;">
                            {% for car in cars %}
                                <option value="{{ car.id }}">{{ car.model }}</option>
                            {% endfor %}
                        </select>
                    </div>


                    <div class="row">
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required" for="engine_number">{% trans 'Dvigitel raqami' %}</label>
                            <input type="text" id="engine_number"
                                   placeholder="{% trans 'Masalan: B12D12345678DJCCX1234' %}">
                        </div>
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required" for="body_number">{% trans 'Kuzov raqami' %}</label>
                            <input type="text" id="body_number"
                                   placeholder="{% trans 'Masalan: XWBJF69VELA102923' %}">
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2" id="chassis_number_div">
                            <label for="chassis_number" class="label_required">{% trans 'Shassi raqami' %}</label>
                            <input type="text" id="chassis_number"
                                   placeholder="{% trans 'Masalan: X8945642519874656' %}">
                        </div>
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2" id="body_type_div">
                            <label for="body_type" class="label_required">{% trans 'Kuzov turi' %}</label>
                            <input type="text" id="body_type"
                                   placeholder="{% trans 'Kuzov turini kiriting' %}">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required" for="color">{% trans 'Rangi' %}</label>
                            <input type="text" id="color"
                                   placeholder="{% trans 'Masalan: GAZ (oq)' %}">
                        </div>

                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required" for="made_year">{% trans 'Yili' %}</label>
                            <input type="number" id="made_year"
                                   placeholder="{% trans 'Masalan: 2020' %}">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required"
                                   for="additionality">{% trans "Qo'shimcha jihozlar" %}</label>
                            <input type="text" id="additionality"
                                   placeholder="{% trans "Masalan: MAXSUS O'QUV" %}">
                        </div>

                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required"
                                   for="cert_seriya">{% trans "Hisob ma'lumotnomasi seriyasi" %}</label>
                            <input type="text" id="cert_seriya"
                                   placeholder="{% trans 'Masalan: AAC' %}">
                        </div>
                    </div>

                    <div class="row">

                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required"
                                   for="cert_number">{% trans "Hisob ma'lumotnomasi raqami" %}</label>
                            <input type="number" id="cert_number"
                                   placeholder="{% trans 'Masalan: 0012345' %}" name="cert_number">
                        </div>

                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <label class="label_required"
                                   for="date_conclusion_contract">{% trans "Shartnoma tuzilgan sana" %}</label>
                            {#                            <div class="input-group-prepend">#}
                            {#                                <span class="input-group-text"><i class="far fa-calendar-alt"></i></span>#}
                            {#                            </div>#}
                            <input type="date" name="date_conclusion_contract" id='date_conclusion_contract'
                                   style="margin-top: 0"
                                   data-inputmask-alias="datetime"
                                   data-inputmask-inputformat="dd/mm/yyyy" data-mask placeholder="01/12/2020">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 col-md-6 col-sm-6 col-lg-6 col-xl-6 mt-2">
                            <div id="accountStatementPhotoPreview">
                                <label class="not_copy" for="accountStatementPhoto">Xisob ma'lumotnoma
                                    suratini yuklang</label>

                                <input type="file" name="photo" hidden
                                       id="accountStatementPhoto" accept=".jpg, .jpeg, .png, .gif"/>

                                <img style='width: 120px; height: auto;display: none' id='accountStatementThumbnail'
                                     src="" title='Image'/>
                                <span style="display: none" id='accountStatementRemove'>O'chirish</span>
                            </div>
                            <p id="accountStatementPhotoError"
                               style="font-size: smaller; margin-top: 0; padding-top: 0; margin-bottom: 0; display: none; float: left"
                               class="form-text text-danger">Xisob ma'lumotnoma surati yuklanmagan</p>
                        </div>
                    </div>


                    <div class="text-right mt-3">
                        <button id="prev2" class="btn btn-secondary col-3 col-md-2 col-sm-2 col-lg-2 col-xl-2 m-2">
                            Oldingi
                        </button>
                        <button id="next2" class="btn btn-primary col-3 col-md-2 col-sm-2 col-lg-2 col-xl-2 m-2">
                            Keyingi
                        </button>
                    </div>
                </div>
                <div id="step-3">
                    <div class="row no-gutters d-flex justify-content-center">
                        <div class="col-md-10">
                            <div class="payment-info">
                                <div class="row">
                                    <h3 class="text-xs-center">To'lov turlari</h3>
                                    <img class="img-fluid cc-img"
                                         src="http://www.prepbootstrap.com/Content/images/shared/misc/creditcardicons.png">
                                </div>

                                <div class="mt-2">
                                    <label class="credit-card-label label_required">Karta egasi</label>
                                    <input type="text" class="credit-inputs" placeholder="Masalan: Abdullayev Bahtiyor">
                                </div>
                                <div class="mt-2">
                                    <label class="credit-card-label label_required">Karta raqami</label>
                                    <input type="text" class="credit-inputs"
                                           placeholder="0000 0000 0000 0000">
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-6">
                                        <label class="credit-card-label label_required">Vaqti</label>
                                        <input type="text" class="credit-inputs" placeholder="12/24">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="credit-card-label label_required">Maxfiy kod</label>
                                        <input type="text" class="credit-inputs" placeholder="342">
                                    </div>
                                </div>
                                <hr class="line">
                                <div class="d-flex justify-content-between information">
                                    <span>Yangi raqam uchun</span>
                                    <span>560 000 so'm</span>
                                </div>
                                <hr style="margin: 0; background-color: #b6b6b6">
                                <div class="d-flex justify-content-between information">
                                    <span>Tex passport uchun</span>
                                    <span>350 000 so'm</span>
                                </div>
                                <hr style="margin: 0; background-color: #b6b6b6">
                                <div class="d-flex justify-content-between information">
                                    <span>Ro'yhatlash uchun</span>
                                    <span>22 300 so'm</span>
                                </div>
                                <hr style="margin: 0; background-color: #b6b6b6">
                                <div class="d-flex justify-content-between information">
                                    <span>Qayta ro'yhatlash uchun</span>
                                    <span>44 600 so'm</span>
                                </div>
                                <hr style="margin: 0; background-color: #3e3e3e">
                                <div class="d-flex justify-content-between information">
                                    <span><b>Jami to'lov</b></span>
                                    <span><b>976 900 so'm</b></span>
                                </div>
                                <button id="next3"
                                        class="btn btn-primary btn-block d-flex justify-content-between mt-3 mb-3"
                                        type="button">
                                    <span>394 600 so'm</span>
                                    <span>To'lash<i class="fa fa-long-arrow-right ml-1"></i>
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="step-3-2">
                    <div class="alert-danger mb-2 text-center">Ushbu to'lovlarni hisob-raqamingizdan pul ko'chirish
                        yo'li
                        orqali to'lang!!!
                    </div>
                    <div id="render_div" class="row no-gutters d-flex justify-content-center">
                        <div class="col-md-10">
                            <div class="payment-info table-responsive-sm">
                                <table class="table table-bordered">
                                    <thead class="thead-light">
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Hujjat nomi</th>
                                        <th scope="col">Hisob raqami</th>
                                        <th scope="col">Summasi</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <tr>
                                        <td>1</td>
                                        <th scope="row">Yo'l fondi ot kuchi</th>
                                        <td>401422860406242342210179</td>
                                        <td>33 000</td>
                                    </tr>

                                    <tr>
                                        <td>2</td>
                                        <th scope="row">Texnik ko'rik</th>
                                        <td>401422860406242342210179</td>
                                        <td>22 300</td>
                                    </tr>

                                    <tr>
                                        <td>3</td>
                                        <th scope="row">Ro'yhatlash</th>
                                        <td>401422860406242342210179</td>
                                        <td>22 300</td>
                                    </tr>

                                    <tr>
                                        <td>4</td>
                                        <th scope="row">Qayta ro'yhatlash</th>
                                        <td>401422860406242342210179</td>
                                        <td>44 600</td>
                                    </tr>
                                    </tbody>

                                    <tfoot>
                                    <tr>
                                        <td></td>
                                        <th class="row">Jami:</th>
                                        <td></td>
                                        <td><b>366 000</b></td>
                                    </tr>
                                    </tfoot>
                                </table>
                                <div class="text-right mt-3">
                                    <button id="render_pdf"
                                            class="btn btn-secondary col-4 col-md-3 col-sm-3 col-lg-3 col-xl-3 m-2">
                                        PDF holatda
                                        chiqarish
                                    </button>
                                    <button id="next3-2"
                                            class="btn btn-primary col-3 col-md-2 col-sm-2 col-lg-2 col-xl-2 m-2">
                                        Keyingi
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="step-4">
                    <div class="container bootstrap snippets bootdey">
                        <div class="div">
                            <div class="alert-danger mb-2 text-center">Ariza nusxasini chiqarib olib transport
                                vositrasini
                                YXXB noziri ko'rigidan o'tkazgandan so'ng arizani qayta yuklang!!!
                            </div>
                            <div class="h2 text-center text-danger">Amallar xronologiyasi</div>

                            <div class="text-right mt-2 mb-2">
                                <button id="application_render_pdf"
                                        class="btn btn-outline-secondary col-4 col-md-3 col-sm-3 col-lg-3 col-xl-3 m-2">
                                    PDF holatda
                                    chiqarish
                                </button>
                            </div>

                            <div class="col-12" style="font-size: 0.9em">
                                <div class="panel-group drop-accordion" id="accordion" role="tablist"
                                     aria-multiselectable="true">
                                    <div class="panel panel-default">
                                        <div class="panel-heading tab-collapsed" role="tab" id="headingOne">
                                            <h4 class="panel-title">
                                                <a class="collapse-controle" data-toggle="collapse"
                                                   data-parent="#accordion"
                                                   href="#collapseOne" aria-expanded="false"
                                                   aria-controls="collapseOne">
                                                    Ariza haqida ma'lumot
                                                    <span class="expand-icon-wrap"><i style="padding: 0.5em"
                                                                                      class="fas fa-angle-double-down"></i></span>
                                                </a>

                                            </h4>
                                        </div>

                                        <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel"
                                             aria-labelledby="headingOne" aria-expanded="false">
                                            <div class="panel-body">
                                                <table class="table table-bordered">
                                                    <tbody>
                                                    <tr>
                                                        <th scope="row">Ariza raqami:</th>
                                                        <td id="application_id"></td>
                                                    </tr>
                                                    <tr>
                                                        <th scope="row">Tekshirish uchun parol:</th>
                                                        <td id="application_pass" class="text-danger"></td>
                                                    </tr>
                                                    <tr>
                                                        <th scope="row">Xizmat nomi:</th>
                                                        <td>Xisob ma'lumotnomasiga asosan avtotransport vositasiga raqam
                                                            olish
                                                        </td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Yaratdi:</th>
                                                        <td id="application_created_user"></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Ariza nusxasi</th>
                                                        <td><a class="copy_application" href="#">Yuklab olish</a></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Berilgan sana:</th>
                                                        <td id="created_date"></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Oxirgi o'zgarish sanasi:</th>
                                                        <td id="updated_date"></td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default">
                                        <div class="panel-heading tab-collapsed" role="tab" id="headingTwo">
                                            <h4 class="panel-title">
                                                <a class="collapse-controle collapsed" data-toggle="collapse"
                                                   data-parent="#accordion" href="#collapseTwo" aria-expanded="false"
                                                   aria-controls="collapseTwo">
                                                    Ariza topshiruvchi
                                                    <span class="expand-icon-wrap"><i style="padding: 0.5em"
                                                                                      class="fas fa-angle-double-down"></i></span>
                                                </a>
                                            </h4>
                                        </div>
                                        <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel"
                                             aria-labelledby="headingTwo" aria-expanded="false" style="height: 0px;">
                                            <div class="panel-body">
                                                <table id="created_is_person" class="table table-bordered">
                                                    <tbody>
                                                    <tr>
                                                        <th scope="row">Familiya:</th>
                                                        <td>{{ request.user.last_name }}</td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Ism:</th>
                                                        <td>{{ request.user.first_name }}</td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Otasining ismi:</th>
                                                        <td>{{ request.user.middle_name }}</td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Passport:</th>
                                                        <td>{{ request.user.passport_seriya }} {{ request.user.passport_number }}</td>
                                                    </tr>

                                                    </tbody>
                                                </table>
                                                <table id="created_is_organization" style="display: none"
                                                       class="table table-bordered">
                                                    <tbody>
                                                    <tr>
                                                        <th scope="row">Tashkilot:</th>
                                                        <td id="organization_title"></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Rahbari:</th>
                                                        <td id="organization_director"></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">STIR raqam:</th>
                                                        <td id="organization_identification_number"></td>
                                                    </tr>

                                                    <tr>
                                                        <th scope="row">Yuridik manzil:</th>
                                                        <td id="organization_legal_address"></td>
                                                    </tr>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default">
                                        <div class="panel-heading tab-collapsed" role="tab" id="headingThree">
                                            <h4 class="panel-title">
                                                <a class="collapsed collapse-controle" data-toggle="collapse"
                                                   data-parent="#accordion" href="#collapseThree" aria-expanded="false"
                                                   aria-controls="collapseThree">
                                                    Mavjud fayllar
                                                    <span class="expand-icon-wrap"><i style="padding: 0.5em"
                                                                                      class="fas fa-angle-double-down"></i></span>
                                                </a>
                                            </h4>
                                        </div>
                                        <div id="collapseThree" class="panel-collapse collapse" role="tabpanel"
                                             aria-labelledby="headingThree" aria-expanded="false">
                                            <div class="panel-body">
                                                <table class="table table-bordered">
                                                    <thead class="thead-light">
                                                    <tr>
                                                        <th scope="col">#</th>
                                                        <th scope="col">Hujjat nomi</th>
                                                        <th scope="col">Holati</th>
                                                        <th scope="col">Hujjat havolasi</th>
                                                        <th scope="col">Pin kod</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>

                                                    <tr>
                                                        <td>1</td>
                                                        <th scope="row">Ariza nusxasi</th>
                                                        <td>Yaxshi</td>
                                                        <td><a class="copy_application" href="#">Yuklab olish</a></td>
                                                        <td>56345</td>
                                                    </tr>

                                                    <tr>
                                                        <td>1</td>
                                                        <th scope="row">Passport</th>
                                                        <td>Yaxshi</td>
                                                        <td><a href="#" target="_blank" id="passport_photo">Yuklab
                                                            olish</a>
                                                        </td>
                                                        <td>12345</td>
                                                    </tr>

                                                    <tr>
                                                        <td>2</td>
                                                        <th scope="row">Xisob ma'lumotnomasi</th>
                                                        <td>Yaxshi</td>
                                                        <td><a href="#" target="_blank" id="account_statement_photo">Yuklab
                                                            olish</a></td>
                                                        <td>56845</td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default">
                                        <div class="panel-heading tab-collapsed" role="tab" id="headingFour">
                                            <h4 class="panel-title">
                                                <a class="collapsed collapse-controle" data-toggle="collapse"
                                                   data-parent="#accordion" href="#collapseFour" aria-expanded="false"
                                                   aria-controls="collapseFour">
                                                    To'lov
                                                    <span class="expand-icon-wrap"><i style="padding: 0.5em"
                                                                                      class="fas fa-angle-double-down"></i></span>
                                                </a>
                                            </h4>
                                        </div>
                                        <div id="collapseFour" class="panel-collapse collapse" role="tabpanel"
                                             aria-labelledby="headingFour" aria-expanded="false">
                                            <div class="panel-body">
                                                <table class="table table-bordered table-responsive">
                                                    <thead class="thead-light">
                                                    <tr>
                                                        <th scope="col">Karta egasi</th>
                                                        <th scope="col">Karta raqami</th>
                                                        <th scope="col" style="width: 4%">Amal qilish muddati</th>
                                                        <th scope="col">Yangi raqam</th>
                                                        <th scope="col">Yangi tex passport</th>
                                                        <th scope="col">Ro'yhatlash</th>
                                                        <th scope="col">Qayta ro'yhatlash</th>
                                                        <th scope="col"><b>Jami</b></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr>
                                                        <th scope="row">Yoqubov Sirojidin</th>
                                                        <td>9860 0230 5693 8972</td>
                                                        <td><a href="#">05/23</a></td>
                                                        <td>560 100 so'm</td>
                                                        <td>350 000 so'm</td>
                                                        <td>22 300 so'm</td>
                                                        <td>44 600 so'm</td>
                                                        <td><b>976 900 so'm</b></td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default">
                                        <div class="panel-heading tab-collapsed" role="tab" id="headingFifth">
                                            <h4 class="panel-title">
                                                <a class="collapsed collapse-controle" data-toggle="collapse"
                                                   data-parent="#accordion" href="#collapseFifth" aria-expanded="false"
                                                   aria-controls="collapseFifth">
                                                    Ariza holati
                                                    <span class="expand-icon-wrap"><i style="padding: 0.5em"
                                                                                      class="fas fa-angle-double-down"></i></span>
                                                </a>
                                            </h4>
                                        </div>
                                        <div id="collapseFifth" class="panel-collapse collapse" role="tabpanel"
                                             aria-labelledby="headingFifth" aria-expanded="false">
                                            <div class="panel-body">
                                                <table class="table table-bordered">
                                                    <thead class="thead-light">
                                                    <tr>
                                                        <th scope="col">Holat</th>
                                                        <th scope="col">Sababi</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr>
                                                        <th scope="row"><p style="color: #0f6674">Jarayonda</p></th>
                                                        <td>O'rganib chiqilmoqda</td>
                                                    </tr>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- /#accordion -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
{% block bottom %}

    <script src="{% static 'plugins/select2/js/select2.full.min.js' %}"></script>
    <script src="{% static 'plugins/select2/js/select2.full.min.js' %}"></script>
    <script src="{% static 'plugins/moment/moment.min.js' %}"></script>
    <script src="{% static 'plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js' %}"></script>
    <script src="{% static 'plugins/inputmask/min/jquery.inputmask.bundle.min.js' %}"></script>
    <script src="{% static 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script type="text/javascript"
            src="https://res.cloudinary.com/dxfq3iotg/raw/upload/v1581152197/smartwizard/jquery.smartWizard.min.js"></script>
    <script src="{% static 'js/jsPdf/jspdf.js' %}"></script>
    <script src="{% static 'js/jsPdf/modules/html.js' %}"></script>
    <script src="{% static 'js/jsPdf/modules/split_text_to_size.js' %}"></script>
    <script src="{% static 'js/jsPdf/modules/standard_fonts_metrics.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="{% static 'js/html2canvas.min.js' %}"></script>
    <script type="text/javascript" charset="UTF-8">
        $(function () {
            //Initialize Select2 Elements
            $('.select2').select2()
            //  $('.select2bs4').select2({
            //     theme: 'bootstrap4'
            // })

            $('#datemask').inputmask('dd/mm/yyyy', {'placeholder': 'dd/mm/yyyy'})
            //Datemask2 mm/dd/yyyy
            $('#datemask2').inputmask('mm/dd/yyyy', {'placeholder': 'mm/dd/yyyy'})
            //Money Euro
            $('[data-mask]').inputmask()
            $("#chassis_number_div").hide()
            $("#body_type_div").hide()
            $('#organization_div_alert').hide()


        })
        $(document).ready(function () {
            var is_truck = false,
                is_legal = false,
                csrftoken = getCookie('csrftoken')

            $.ajaxSetup({
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('X-CSRFToken', csrftoken)
                }
            })

            $('#collapseOne').collapse('show');

            $('#smartwizard').smartWizard({
                selected: 0,
                theme: 'arrows',
                autoAdjustHeight: true,
                transitionEffect: 'fade',
                showStepURLhash: false,
                toolbarSettings: {
                    toolbarPosition: 'none', // none, top, bottom, both
                    toolbarButtonPosition: 'right', // left, right, center
                    showNextButton: false, // show/hide a Next button
                    showPreviousButton: false, // show/hide a Previous button
                    toolbarExtraButtons: [] // Extra buttons to show on toolbar, array of jQuery input/buttons elements
                },

            });

            var selectedCar = $("select#car").children("option:selected").val();
            $.ajax({
                type: "GET",
                url: "{% url 'account_statement:get_car_type' %}",
                data: {
                    'car': selectedCar, // from form
                },
                success: function (message) {
                    if (message === "1") {
                        $("#chassis_number_div").fadeIn()
                        $("#body_type_div").fadeIn()
                        is_truck = true
                    } else {
                        $("#chassis_number_div").fadeOut()
                        $("#body_type_div").fadeOut()
                        is_truck = false
                    }
                }

            });

            $("select#car").change(function () {
                var selectedCar = $(this).children("option:selected").val();
                $.ajax({
                    type: "GET",
                    url: "{% url 'account_statement:get_car_type' %}",
                    data: {
                        'car': selectedCar, // from form
                    },
                    success: function (message) {
                        if (message === "1") {
                            $("#chassis_number_div").fadeIn()
                            $("#body_type_div").fadeIn()
                            is_truck = true
                        } else {
                            $("#chassis_number_div").fadeOut()
                            $("#body_type_div").fadeOut()
                            is_truck = false
                        }
                    }

                });
            });

            $('#div_organization').hide()

            $("#person_type").change(function () {
                var selectedPersonType = $(this).children("option:selected").val();

                $.ajax({
                    type: 'GET',
                    url: '{% url "user:get_organization" %}',
                    data: {'organization': $('#organization option:selected').val()},
                    success: function (response) {
                        $('#director').attr('placeholder', response.fields.director)
                        $('#legal_address').attr('placeholder', response.fields.legal_address)
                        $('#identification_number').attr('placeholder', response.fields.identification_number)

                        $('#organization_title').html(response.fields.title)
                        $('#organization_director').html(response.fields.director)
                        $('#organization_legal_address').html(response.fields.legal_address)
                        $('#organization_identification_number').html(response.fields.identification_number)
                    }
                })

                if (selectedPersonType === 'Y') {
                    $('#div_organization').show()
                    $('#msdiv1').hide()
                    $('#msdiv2').show()
                    is_legal = true

                    $('#created_is_organization').show()
                    $('#created_is_person').hide()

                    $('#organization').on('change', function () {
                        $.ajax({
                            type: 'GET',
                            url: '{% url "user:get_organization" %}',
                            data: {'organization': $('#organization option:selected').val()},
                            success: function (response) {
                                $('#director').attr('placeholder', response.fields.director)
                                $('#legal_address').attr('placeholder', response.fields.legal_address)
                                $('#identification_number').attr('placeholder', response.fields.identification_number)

                                $('#organization_title').html(response.fields.title)
                                $('#organization_director').html(response.fields.director)
                                $('#organization_legal_address').html(response.fields.legal_address)
                                $('#organization_identification_number').html(response.fields.identification_number)
                            }
                        })
                    })

                } else if (selectedPersonType === 'J') {
                    $('#msdiv1').show()
                    $('#msdiv2').hide()
                    $('#div_organization').css('display', 'none')
                    is_legal = false

                    $('#created_is_organization').hide()
                    $('#created_is_person').show()
                }

                if (typeof ($('#organization option').attr('value')) == 'undefined') {
                    $('#div_organization').hide()
                    $('#organization_div_alert').show()
                    $('#person_type option[value=J]').attr('selected', 'selected')
                    $('#person_type').prop('disabled', 'disabled')
                    $('#msdiv1').show()
                    $('#msdiv2').hide()
                } else {

                    $('#organization_div_alert').hide()
                    if (selectedPersonType === 'Y') {
                        $('#div_organization').show()
                    }
                }


                //  $("#organization_div").fadeIn()
                //  $("#organization_div_alert").fadeIn()

            });

            $('#accountStatementPhoto').on('change', function (event) {
                var files = event.target.files; //FileList object
                for (var i = 0; i < files.length; i++) {
                    var file = files[i];

                    //Only pics
                    if (!file.type.match('image'))
                        continue;
                    var picReader = new FileReader();
                    picReader.addEventListener("load", function (event) {
                        var picFile = event.target;
                        //  var div = document.createElement("div");
                        $('#accountStatementPhotoPreview label').hide()
                        $('#accountStatementThumbnail').show()
                        $('#accountStatementRemove').show()
                        $('#accountStatementThumbnail').attr('src', picFile.result)
                        $('#accountStatementPhotoError').hide()
                        // result.innerHTML = "<img style='width: 150px; height: auto' id='thumbnail' src='" + picFile.result + "'" +
                        //   "title='Image'/><span  id='remove'>O'chirish</span>";
                        //  result.insertBefore(div, null);
                        $("#accountStatementRemove").click(function () {
                            $('#accountStatementPhotoPreview label').show()
                            $('#accountStatementThumbnail').hide()
                            $('#accountStatementRemove').hide()
                            $('#accountStatementPhotoError').show()
                        });
                    });
                    //Read the image
                    picReader.readAsDataURL(file);
                }
            })


            $('#next1').on('click', function () {
                $('#step-1').hide()
                $('#step-2').show()
                $('#nav-2').removeClass().addClass('nav-item active')

            })


            $('#prev2').on('click', function () {

                $('#step-1').show()
                $('#step-2').hide()

            })

            $('#next2').on('click', function () {

                var is_truck_save = false
                if (is_truck === true) {
                    if ($('#engine_number').val() == '') {
                        $('#engine_number').css("border-bottom", "2px solid red")
                    } else if ($('#body_number').val() == '') {
                        $('#body_number').css("border-bottom", "2px solid red")
                    } else if ($('#chassis_number').val() == '') {
                        $('#chassis_number').css("border-bottom", "2px solid red")
                    } else if ($('#body_type').val() == '') {
                        $('#body_type').css("border-bottom", "2px solid red")
                    } else if ($('#color').val() == '') {
                        $('#color').css("border-bottom", "2px solid red")
                    } else if ($('#made_year').val() == '') {
                        $('#made_year').css("border-bottom", "2px solid red")
                    } else if ($('#additionality').val() == '') {
                        $('#additionality').css("border-bottom", "2px solid red")
                    } else if ($('#cert_seriya').val() == '') {
                        $('#cert_seriya').css("border-bottom", "2px solid red")
                    } else if ($('#cert_number').val() == '') {
                        $('#cert_number').css("border-bottom", "2px solid red")
                    } else if (isNaN(parseDate($('#date_conclusion_contract').val()))) {
                        $('#date_conclusion_contract').css("border-bottom", "2px solid red")
                    } else if ($('#accountStatementPhoto').val() === '') {
                        $('#accountStatementPhotoError').show()
                    } else {
                        is_truck_save = true
                        save_car_information()
                    }

                } else {
                    if ($('#engine_number').val() == '') {
                        $('#engine_number').css("border-bottom", "2px solid red")
                    } else if ($('#body_number').val() == '') {
                        $('#body_number').css("border-bottom", "2px solid red")
                    } else if ($('#color').val() == '') {
                        $('#color').css("border-bottom", "2px solid red")
                    } else if ($('#made_year').val() == '') {
                        $('#made_year').css("border-bottom", "2px solid red")
                    } else if ($('#additionality').val() == '') {
                        $('#additionality').css("border-bottom", "2px solid red")
                    } else if ($('#cert_seriya').val() == '') {
                        $('#cert_seriya').css("border-bottom", "2px solid red")
                    } else if ($('#cert_number').val() == '') {
                        $('#cert_number').css("border-bottom", "2px solid red")
                    } else if (isNaN(parseDate($('#date_conclusion_contract').val()))) {
                        $('#date_conclusion_contract').css("border-bottom", "2px solid red")
                    } else if ($('#accountStatementPhoto').val() === '') {
                        $('#accountStatementPhotoError').show()
                    } else {
                        save_car_information()
                    }
                }

                function save_car_information() {
                    $('#next2').attr('disabled', 'disabled')
                    $('#person_type').attr('disabled', 'disabled')
                    $('#organization').attr('disabled', 'disabled')
                    $('#car').attr('disabled', 'disabled')
                    var fd = new FormData();
                    var accountStatementPhoto = $('#accountStatementPhoto')[0].files[0];


                    fd.append('accountStatementPhoto', accountStatementPhoto);
                    if (is_truck_save === true) {
                        fd.append('chassis_number', $('#chassis_number').val());
                        fd.append('body_type', $('#body_type').val());
                    }

                    if (is_legal === true) {
                        fd.append('organization', $('#organization option:selected').val());
                        fd.append('person_type', $('#person_type').children("option:selected").val());
                    } else {
                        fd.append('person_type', $('#person_type').children("option:selected").val());
                    }

                    fd.append('car', $('#car').children("option:selected").val());
                    fd.append('engine_number', $('#engine_number').val());
                    fd.append('body_number', $('#body_number').val());
                    fd.append('color', $('#color').val());
                    fd.append('made_year', $('#made_year').val());
                    fd.append('additionality', $('#additionality').val());
                    fd.append('cert_seriya', $('#cert_seriya').val());
                    fd.append('cert_number', $('#cert_number').val());
                    fd.append('date_conclusion_contract', $('#date_conclusion_contract').val());

                    $.ajax({
                        type: 'POST',
                        url: '{% url "application:save_application_information" %}',
                        data: fd,
                        contentType: false,
                        processData: false,
                        success: function (response) {
                            if (response) {
                                $('.copy_application').attr('href', `/media/applications/${response.pk}.docx`)

                                $('#application_id').html(response.pk)
                                $('#application_pass').html(response.fields.password)

                                $.ajax({
                                    type: 'GET',
                                    url: '{% url "application:get_information" %}',
                                    data: {
                                        'user': response.fields.created_user,
                                        'application': response.pk

                                    },
                                    success: function (messege) {

                                        $('#application_created_user').html(messege.user)
                                        $('#passport_photo').attr('href', messege.passport_photo_url)
                                        $('#account_statement_photo').attr('href', messege.account_statement_photo_url)
                                    }
                                })

                                var date = response.fields.created_date;
                                var arr = date.split('', 10);
                                var created_date = `${arr[8]}${arr[9]}.${arr[5]}${arr[6]}.${arr[0]}${arr[1]}${arr[2]}${arr[3]}`
                                $('#created_date').text(created_date)

                                var date2 = response.fields.updated_date;
                                var arr2 = date2.split('', 10);
                                var updated_date = `${arr2[8]}${arr2[9]}.${arr2[5]}${arr2[6]}.${arr2[0]}${arr2[1]}${arr2[2]}${arr2[3]}`
                                $('#updated_date').text(updated_date)


                                $('#step-2').hide()
                                if (is_legal === true) {
                                    $('#step-3').hide()
                                    $('#step-3-2').show()
                                } else {
                                    $('#step-3').show()
                                    $('#step-3-2').hide()
                                }
                                $('#nav-3').removeClass().addClass('nav-item active')
                            }
                        }
                    })


                }

            })

            $('#next3').on('click', function () {
                $(this).attr('disabled', 'disabled')
                $('#step-3').hide()
                $('#step-4').show()
                $('#nav-4').removeClass().addClass('nav-item active')

            })

            $('#next3-2').on('click', function () {
                $(this).attr('disabled', 'disabled')
                $('#step-3').hide()
                $('#step-3-2').hide()
                $('#step-4').show()
                $('#nav-4').removeClass().addClass('nav-item active')

            })

            $('#nav-1').on('click', function () {
                if ($('#nav-1').hasClass('active')) {
                    $('#step-1').show()
                    $('#step-2').hide()
                    $('#step-3').hide()
                    $('#step-4').hide()
                }

            })

            $('#nav-2').on('click', function () {
                if ($('#nav-2').hasClass('active')) {
                    $('#step-1').hide()
                    $('#step-2').show()
                    $('#step-3').hide()
                    $('#step-4').hide()
                }
            })

            $('#nav-3').on('click', function () {
                if ($('#nav-3').hasClass('active')) {
                    $('#step-1').hide()
                    $('#step-2').hide()
                    if (is_legal === true) {
                        $('#step-3').hide()
                        $('#step-3-2').show()
                    } else {
                        $('#step-3').show()
                        $('#step-3-2').hide()
                    }
                    $('#step-4').hide()
                }
            })

            $('#nav-4').on('click', function () {
                if ($('#nav-4').hasClass('active')) {
                    $('#step-1').hide()
                    $('#step-2').hide()
                    $('#step-3').hide()
                    $('#step-3-2').hide()
                    $('#step-4').show()
                }
            })

            $(document).on('focusout', '#body_type, #body_number, #chassis_number, #engine_number, #made_year,#additionality, #color, #cert_seriya, #cert_number', function (e) {
                if (e.target.value !== '') {
                    $(e.target).css("border-bottom", "2px solid green")
                } else {
                    $(e.target).css("border-bottom", "2px solid red")
                }
            })

            $(document).on('focusout', '#date_conclusion_contract', function (e) {
                if (parseDate(e.target.value)) {
                    $(e.target).css("border-bottom", "2px solid green")
                } else {
                    $(e.target).css("border-bottom", "2px solid red")
                }
            })

            $('#render_pdf').on('click', function () {

                var pdf = new jsPDF('p', 'pt', 'letter');
                // source can be HTML-formatted string, or a reference
                // to an actual DOM element from which the text will be scraped.
                source = $('#render_div')[0];

                // we support special element handlers. Register them with jQuery-style
                // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
                // There is no support for any other type of selectors
                // (class, of compound) at this time.
                specialElementHandlers = {
                    // element with id of "bypass" - jQuery style selector
                    '#bypassme': function (element, renderer) {
                        // true = "handled elsewhere, bypass text extraction"
                        return true
                    }
                };
                margins = {
                    top: 80,
                    bottom: 60,
                    left: 40,
                    width: 1000
                };
                // all coords and widths are in jsPDF instance's declared units
                // 'inches' in this case
                pdf.fromHTML(
                    source, // HTML string or DOM elem ref.
                    margins.left, // x coord
                    margins.top, { // y coord
                        'width': margins.width, // max width of content on PDF
                        'elementHandlers': specialElementHandlers
                    },

                    function (dispose) {
                        // dispose: object with X, Y of the last line add to the PDF
                        //          this allow the insertion of new lines after html
                        pdf.save("To'lov.pdf");
                    }, margins);


            })

            $('#application_render_pdf').on('click', function () {
                window.location.href = "{% url 'application:application_pdf' id=12345 %}".replace(/12345/, $('#application_id').html().toString());
            })


        });
    </script>

{% endblock bottom %}