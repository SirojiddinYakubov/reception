{% load static i18n %}
<!doctype html>
<html lang="uz">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>E-RIB.UZ</title>

    <meta name="title" content="TIZIMGA KIRISH">
    <meta name="description" content="Avtotransport vositasini onlayn ro'yhatdan o'tkazish uchun platforma">
    <meta name="keywords"
          content="texpasport, tex-pasport, avtomobilni ro'yhatga olish, avtotransport, avtomobil, davlat boji, ro'yhatga olish, avtomobilni ro'yhatga olish, yhxb, buxoro obl gai, fayzobod gai">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="language" content="English">
    <meta name="author" content="OPENSOFT">

    <link rel="shortcut icon" href="{% static 'assets/images/favicon.ico' %}">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'assets/libs/animate.css/animate.min.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="{% static 'css/login/style.css' %}">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Righteous&display=swap');

        input:-webkit-autofill,
        input:-webkit-autofill:hover,
        input:-webkit-autofill:focus,
        input:-webkit-autofill:active {
            transition: background-color 5000s ease-in-out 5s !important;
            -webkit-text-fill-color: rgba(255, 255, 255, 0.8) !important;
            -webkit-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.2);
            -moz-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.2);
            box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.2);

        }

        .form-control, .form-control:active {
            border: 2px solid rgba(255, 255, 255, 0.45);
            border-radius: 7px;

        }

        .form-control:hover {
            -webkit-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            -moz-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            border: 2px solid rgba(255, 255, 255, 0.45);
            border-radius: 7px;
        }

        #button_input {
            border-radius: 3px;
            background-color: #efe9e2 !important;
            color: #320365 !important;
            border-color: #fff !important;
            font-weight: bold;
            -webkit-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            -moz-box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            box-shadow: -1px 2px 8px 0px rgba(255, 255, 255, 0.5) !important;
            display: block;
            float: right;

        }


        .head-title {
            font-family: 'Righteous', cursive !important;
            font-size: 3rem;
            color: #fff;

        }

        .link_row {
            width: 100%;
            display: block;
            overflow: hidden;
            margin-top: 10px;
            text-decoration: underline !important;
        }

        .left_link {
            float: left;
            display: block;
            padding-right: 10%;
        }

        .left_link:hover {
            text-decoration: underline !important;
        }

        a {
            text-decoration: underline !important;

        }
    </style>
</head>

<body class="img js-fullheight" style="background-image: url({% static '/css/login/bg.jpg' %});">

<section class="ftco-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center mb-5">
                <h1 class="head-title animate__animated animate__pulse animate__infinite animate__delay-1s">
                    E-RIB.UZ</h1>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="login-wrap p-0">
                    <h3 class="mb-4 text-center">Tizimga kirish</h3>

                    {% include '_parts/messages.html' %}
                    <form action="{% url 'user:login_view' %}" class="signin-form" method="POST">
                        {% csrf_token %}
                        <div class="form-group">
                            <input type="text" class="form-control" name="username" placeholder="Username" required>
                        </div>
                        <div class="form-group">
                            <input id="password-field" type="password" name="password" autocomplete="off"
                                   class="form-control"
                                   placeholder="Password"
                                   required>
                            <span toggle="#password-field" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                        </div>
                        <input type="text" hidden name="next" value="{{ request.GET.next }}">
                        <div class="row">
                            <div class="col-6 col-sm-6">
                                <div class="w-100">
                                    <label class="checkbox-wrap checkbox-primary">eslab qol
                                        <input type="checkbox" name="remember_me" checked>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                            </div>

                            <div class="col-6 col-sm-6">
                                <div class="form-group">
                                    <button type="submit" id="button_input" class=" btn btn-primary submit px-3">
                                        Kirish
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="clearfix"></div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-12 col-sm-12 link_row">
                                    <a class="right_link" href="#" id="forgot_pass" style="color: #fff">Parolni
                                        unutdingizmi?</a>
                                    <a class="left_link" href="{% url 'user:signup' %}" style="color: #fff">Ro'yhatdan
                                        o'tish</a>
                                </div>


                            </div>


                        </div>
                    </form>


                </div>
            </div>
        </div>
    </div>
</section>

<script src="{% static 'js/login/jquery.min.js' %}"></script>
<script src="{% static 'js/login/popper.js' %}"></script>
<script src="{% static 'js/login/bootstrap.min.js' %}"></script>
<script src="{% static 'js/login/main.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-notify@3.1.3/bootstrap-notify.min.js"></script>
<script type="text/javascript">

    $(document).ready(function () {

        var csrftoken = getCookie('csrftoken')

        $.ajaxSetup({
            beforeSend: function (xhr) {
                xhr.setRequestHeader('X-CSRFToken', csrftoken)
            },
        })

        var forgot_pass = $('#forgot_pass')
        forgot_pass.on('click', function () {
            sweetAlertFunc()

            function sweetAlertFunc() {
                swal({
                    title: '{% trans "Parolni unutdingizmi?" %}',
                    {#text: "Siz haqiqatdan ham guruhini o'chirmoqchimisiz ?",#}
                    {#icon: "warning",#}
                    className: "",
                    buttons: [
                        "{% trans "Yo'q" %}",
                        "{% trans "Ha, Parolni tiklash" %}"
                    ],
                    dangerMode: false,
                }).then(function (isConfirm) {
                    if (isConfirm) {
                        swal({
                            text: '{% trans "Telefon raqamingizni kiriting..." %}',
                            buttons: [
                                "{% trans "Orqaga qaytish" %}",
                                "{% trans "Yuborish" %}"
                            ],
                            content: {
                                element: "input",
                                attributes: {
                                    placeholder: "{% trans "Masalan:" %} 919791999",
                                    type: "text",
                                },
                            },
                        }).then(function (inputValue) {
                            if (inputValue.length === 9) {
                                $.ajax({
                                    type: 'POST',
                                    url: '{% url "user:forgot_pass" %}',
                                    data: {
                                        'phone': inputValue,
                                    },
                                    statusCode: {
                                        200: function (res) {
                                            console.log('send sms')
                                            swal({
                                                icon: "success",
                                                text: "{% trans "Login va parol raqamingizga sms tarzida jo'natildi!" %}"
                                            });
                                        },
                                        404: function (err) {
                                            console.log(err)
                                            swal({
                                                text: '{% trans "Bunday raqam tizimda mavjud emas!" %}',
                                                icon: 'error',
                                                buttons: [
                                                    '{% trans "Orqaga qaytish" %}',
                                                    "{% trans "Ro'yhatdan o'tish" %}"
                                                ],
                                            }).then(function (isRegister) {
                                                if (isRegister) {
                                                    window.location.href = '{% url 'user:signup' %}'
                                                }
                                            });
                                        }
                                    },
                                })
                            } else {
                                swal({
                                    text: '{% trans "Raqamni kiritishda xatolik!" %}',
                                    icon: 'error',
                                    buttons: [
                                        '{% trans "Orqaga qaytish" %}',
                                        "{% trans "Qayta urinib ko'rish" %}"
                                    ],
                                }).then(function (isAgain) {
                                    if (isAgain) {
                                        sweetAlertFunc()
                                    }
                                });
                            }
                        });
                    }
                });


                //  swal("Write something here:", {
                //     content: "input",
                //  })
                //      .then((value) => {
                //          swal(`You typed: ${value}`);
                //     });

            }
        })

    })

</script>
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (m, e, t, r, i, k, a) {
        m[i] = m[i] || function () {
            (m[i].a = m[i].a || []).push(arguments)
        };
        m[i].l = 1 * new Date();
        k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)
    })
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(86507697, "init", {
        clickmap: true,
        trackLinks: true,
        accurateTrackBounce: true,
        webvisor: true
    });
</script>
<noscript>
    <div><img src="https://mc.yandex.ru/watch/86507697" style="position:absolute; left:-9999px;" alt=""/></div>
</noscript>
<!-- /Yandex.Metrika counter -->
</body>

</html>

