{% load static %}
<link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<!------ Include the above in your HEAD tag ---------->

<!DOCTYPE html>
<html>
<head>
    <title>Tizimga kirish</title>
    <!--Made with love by Mutiullah Samim -->

    <!--Bootsrap 4 CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!--Fontawesome CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
          integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!--Custom styles-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/login.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

    <link rel="stylesheet" href="{% static '/plugins/fontawesome-free/css/all.min.css' %}">

</head>
<body>
<div class="container">

    <div class="d-flex justify-content-center h-100">
        <div class="card">
            <div class="card-header">
                <h3 class="not_copy">Tizimga kirish</h3>
                <div class="d-flex justify-content-end social_icon">

                    <a title="Yordam kerakmi?" href="https://t.me/Sirojiddin_Yakubov"><span><i
                            style="color: #0088cc; background-color: whitesmoke; border-radius: 140%"
                            class="fab fa-telegram"></i></span></a>
                    <a title="Yordam kerakmi?"
                       href="https://telegra.ph/E-RIB-tizimidanfoydalanish-boyicha-qollanma-08-11"><span><i
                            style="color: #242424; background-color: whitesmoke; border-radius: 120%"
                            class="far fa-question-circle"></i></span></a>
                </div>
            </div>

            {% include 'includes/messages.html' %}

            <div class="card-body">
                <form method="post" action="{% url 'user:login' %}">

                    {% csrf_token %}
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-user custom_icon"></i></span>
                        </div>
                        <input type="text" class="form-control" id="passport" name="passport" autocomplete="off"
                               placeholder="Passport" required>

                    </div>
                    <div class="input-group form-group divWithIcon">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-lock custom_icon"></i></span>
                        </div>

                        <input type="password" id="password" placeholder="Parol" name="password" autocomplete="off"
                               class="form-control" required>
                        <i class="far fa-eye icon-pwd"></i>

                    </div>

                    <div class="row align-items-center remember">
                        <input name="checkbox" style="cursor: pointer" type="checkbox"><span class="not_copy"
                                                                                             style="cursor: pointer"
                                                                                             id="label_remember">Eslab qol</span>
                    </div>
                    <div class="form-group">
                        <input type="submit" value="Kirish" class="btn fourth">
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-center links not_copy">
                    Siz ro'yhatdan o'tganmisiz?

                    <a style="display: block" href="{% url 'user:signup' %}">Ro'yhatdan o'tish</a>
                </div>
                <div class="d-flex justify-content-center">
                    <a href="#" id="forget_pass">Parolni unutdingizmi?</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/bootstrap-notify.min.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>

    $(document).ready(function () {
        var passport = $('#passport'),
            password = $('#password'),
            forget_pass = $('#forget_pass')

        forget_pass.on('click', function () {
            sweetAlertFunc()

            function sweetAlertFunc() {
                swal({
                    title: "Parolni unutdingizmi ?",
                    {#text: "Siz haqiqatdan ham guruhini o'chirmoqchimisiz ?",#}
                    {#icon: "warning",#}
                    className: "",
                    buttons: [
                        'Yoq',
                        'Ha, Parolni tiklash'
                    ],
                    dangerMode: false,
                }).then(function (isConfirm) {
                    if (isConfirm) {
                        swal({
                            text: 'Telefon raqamingizni kiriting...',
                            buttons: [
                                'Orqaga qaytish',
                                'Yuborish'
                            ],
                            content: {
                                element: "input",
                                attributes: {
                                    placeholder: "Masalan: 919791999",
                                    type: "text",
                                },
                            },
                        }).then(function (inputValue) {
                            if (inputValue.length === 9) {
                                $.ajax({
                                    type: 'GET',
                                    url: '{% url "user:forgot_pass" %}',
                                    data: {
                                        'phone': inputValue,
                                    },
                                    success: function (messege) {
                                        if (messege == 'True') {
                                            swal({
                                                icon: "success",
                                                text: "Passport va parol raqamingizga sms tarzida jo'natildi!"
                                            });
                                        } else {
                                            swal({
                                                text: 'Bunday raqam bazada mavjud emas!',
                                                icon: 'error',
                                                buttons: [
                                                    'Orqaga qaytish',
                                                    "Ro'yhatdan o'tish"
                                                ],
                                            }).then(function (isRegister) {
                                                if (isRegister) {
                                                    window.location.href = '{% url 'user:signup' %}'
                                                }
                                            });
                                        }
                                    }

                                })
                            } else {
                                swal({
                                    text: 'Raqamni kiritishda xatolik!',
                                    icon: 'error',
                                    buttons: [
                                        'Orqaga qaytish',
                                        "Qayta urinib ko'rish"
                                    ],
                                }).then(function (isAgain) {
                                    if (isAgain) {
                                        sweetAlertFunc()
                                    }
                                });
                            }
                        });
                    }
                });


                //  swal("Write something here:", {
                //     content: "input",
                //  })
                //      .then((value) => {
                //          swal(`You typed: ${value}`);
                //     });

            }
        })


        $('#label_remember').on('click', function () {
            console.log($(".remember input[name='checkbox']:checked").val())
            if ($(".remember input[name='checkbox']:checked").val()) {

                $(".remember input[name='checkbox']").prop('checked', false);
            } else {

                $(".remember input[name='checkbox']").prop('checked', true);
            }

        })

        passport.keypress(PassportInputFilter)

        $('.divWithIcon i').on('click', function () {
            if ($(this).hasClass('far fa-eye icon-pwd')) {
                $(this).removeClass().addClass('far fa-eye-slash icon-pwd')
                $('#password').attr('type', 'text')
            } else {
                $(this).removeClass().addClass('far fa-eye icon-pwd')
                $('#password').attr('type', 'password')
            }
        })

        password.keypress(function (e) {
            var ew = e.which
            if (ew === 32) {
                e.preventDefault()
            }
        })

    })
</script>


</body>
</html>